View(Production_BCS)
library(ggplot2)
ggplot(Production_BCS, aes(Well, Reservoir, color = "Oil Rate,BOPD")) + geom_point()
ggplot(Production_BCS, aes(Reservoir, Well, color = "Oil Rate,BOPD")) + geom_point()
library(datasets)
library(tidyverse)
library(ggplot2)
ggplot(Production_BCS, aes(Reservoir, Well, color = "Oil Rate,BOPD")) + geom_point()
head(Production_BCS)
summary(Production_BCS)
install.packages("janitor")
library(janitor)
Production <- read_excel("Production_BCS.xlsx")
ggplot(Production, aes(Reservoir, Well, color = "Oil Rate,BOPD")) + geom_point()
head(Production)
summary(Production)
Production <- read_excel("Production_BCS.xlsx") %>% clean_names()
ggplot(Production, aes(Reservoir, Well, color = "Oil Rate,BOPD")) + geom_point()
ggplot(Production, aes(reservoir, well, color = oil_rate_bopd)) + geom_point()
head(Production)
summary(Production)
Production %>% filter(water_rate_bwpd==NA)
Production %>% filter(is.na(water_rate_bwpd))
newdates<-Production %>% filter(date>1974)
newdates
install.packages("lubridate")
install.packages("lubridate")
library(lubridate)
Production %>% select((ymd(date))
Production %>% select(ymd(date))
library(datasets)
library(tidyverse)
library(ggplot2)
library(janitor)
Production <- read_excel("Production_BCS.xlsx") %>% clean_names()
library(readxl)
library(datasets)
library(tidyverse)
library(ggplot2)
library(janitor)
library(readxl)
Production <- read_excel("Production_BCS.xlsx") %>% clean_names()
Production <- read_excel("Production_BCS.xlsx") %>% clean_names()
Production <- read_excel("Production_BCS.xlsx") %>% clean_names()
Production %>% select(ymd(date))
Production %>% select(ymd(date))
Production %>% select(ymd(date))
?ymd
Production %>% select(as.Date(date))
library(datasets)
library(tidyverse)
library(ggplot2)
library(janitor)
library(readxl)
Production <- read_excel("Production_BCS.xlsx",
col_types = c("text", "text", "date",
"numeric", "numeric", "numeric",
"numeric")) %>% clean_names()
head(Production)
summary(Production)
library(lubridate)
newdates<-Production %>% filter(date>1974)
newdates
library(lubridate)
newdates<-Production %>% filter(date<1974)
newdates
library(lubridate)
newdates<-Production %>% filter(date>1974)
newdates
library(lubridate)
newdates<-Production %>% filter(date>1970)
newdates
library(lubridate)
newdates<-Production %>% filter(date>1975)
newdates
library(lubridate)
newdates<-Production %>% filter(date>1974)
newdates
library(lubridate)
newdates<-Production %>% filter(date>1976)
newdates
library(lubridate)
newdates<-Production %>% filter(date>1980)
newdates
Production %>% select(ymd(date))
Production %>% select(as.Date(date))
Production %>% select(as.Date.character(date))
Production[1,,3]
Production[1,3]
typeof(Production[1,3])
str(Production[1,3])
attributes(Production[1,3])
Production$date
ymd(Production$date)
Production$date<-ymd(Production$date)
newdates<-Production %>% filter(date>1974)
newdates
newdates<-Production %>% filter(date>=1974)
newdates
newdates<-Production %>% filter(date>1973)
newdates
#1978 82 86 90 94 98 02 06 10 14
newdates %>% filter(date==range(1978,2015,4))
?range
#1978 82 86 90 94 98 02 06 10 14
newdates %>% filter(date==seq_along(1978,2015,4))
#1978 82 86 90 94 98 02 06 10 14
newdates %>% filter(date==seq(1978,2015,4))
#1978 82 86 90 94 98 02 06 10 14
newdates %>% filter(date==seq(1978, 1982))
#1978 82 86 90 94 98 02 06 10 14
newdates %>% filter(date==c(1978, 1982))
?seq
#1978 82 86 90 94 98 02 06 10 14
years<- seq(1978,2014,4)
newdates %>% filter(date %in% years)
newdates %>% filter(date 1994)
newdates %>% filter(date==1994)
newdates %>% filter(date>1994 & date <1995)
newdates %>% filter(date>1994 && date <1995)
newdates %>% filter(date<1994)
newdates %>% filter(date<1974)
newdates %>% filter(date>1974)
newdates %>% filter(date>1994)
newdates %>% filter(date>1995)
newdates %>% filter(date==1995)
newdates %>% filter(date==1995-01-01)
newdates %>% filter(year(date)==1994)
newdates %>% filter(year(date) %in%years)
newdates %>% filter(year(date) 1994) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd)
newdates %>% filter(year(date)== 1994) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd)
newdates %>% filter(year(date)== 1994) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale()
library(stats4)
newdates %>% filter(year(date)== 1994) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
library(stats4)
clust1<- newdates %>% filter(year(date)== 1994) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
install.packages("factoextra")
library(factoextra)
fviz_clust(clust1)
fviz_cluster(clust1)
fviz_cluster(clust1, data=newdates)
clust_data<- newdates %>% filter(year(date)==1994) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
fviz_cluster(clust1, data=clust_data)
clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(Production)) %>%  ggplot(aes(x=oil_rate_bopd, y=gas_rate_mscf_d, color = factor(cluster), label=well))+geom_text()
clust_data<- newdates %>% filter(year(date)==1994) %>% select(well,oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_data<- newdates %>% filter(year(date)==1994) %>% select(well,oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale(oil_rate_bopd,gas_rate_mscf_d,water_rate_bwpd)
clust_data<- newdates %>% filter(year(date)==1994) %>% select(well,oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale(c(oil_rate_bopd,gas_rate_mscf_d,water_rate_bwpd))
clust_names<- newdates %>% filter(year(date)==1994) %>% select(well)
library(factoextra)
fviz_cluster(clust1, data=clust_data)
clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(Production)) %>%  ggplot(aes(x=oil_rate_bopd, y=gas_rate_mscf_d, color = factor(cluster), label=clust_names$well))+geom_text()
clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well)) %>%  ggplot(aes(x=oil_rate_bopd, y=gas_rate_mscf_d, color = factor(cluster), label=clust_names$well))+geom_text()
clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well)) %>%  ggplot(aes(x=oil_rate_bopd, y=gas_rate_mscf_d, color = factor(cluster)))
clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well)) %>%  ggplot(aes(x=oil_rate_bopd, y=gas_rate_mscf_d, color = factor(cluster)))+ geom_point()
clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well)) %>%  ggplot(aes(x=water_rate_bwpd, y=gas_rate_mscf_d, color = factor(cluster)))+ geom_point()
llibrary(rgl)
library(rgl)
install.packages(rgl)
install.packages("rgl")
library(rgl)
plot3d(clust_data$cluster[,] col=clust_names$well)
```{r}
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
clust_data %>%   ggplot(aes(x=water_rate_bwpd, y=gas_rate_mscf_d, color = factor(cluster)))+ geom_point()
plot3d(clust_data$cluster[,], col=clust_names$well)
clust_data
plot3d(clust_data[,1:3], col=clust_names$well)
clust_data
plot3d(clust_data[,1:3], col=clust_data$well)
plot3d(clust_data[,1:3], col=c("red","blue","green"))
clust_data
clust_data %>% mutate(color= if(cluster==1){
color="red"
})
color="blue"
clust_data %>% mutate(color= if(cluster==1){
color="red"
})
clust_data %>% mutate(color= if(cluster==2){
color="blue"
})
library(rgl)
plot3d(clust_data[,1:3], col=c("red","blue","green"))
plot3d(clust_data[,1:3], col=c("red","blue","green"))
clust_data %>% mutate(color= if(cluster==1){
color="red"
})
clust_data %>% mutate(color= if(cluster==2){
color="blue"
})
library(rgl)
plot3d(clust_data[,1:3], col=c("red","blue","green"))
clust_data %>% mutate(color= if(cluster==1){
color="red"
})
library(rgl)
plot3d(clust_data[,1:3], col=c("red","blue","green"))
clust_data %>% mutate(color= if(cluster==1,2){
clust_data %>% mutate(color= if(cluster==1){
color="red"
}) %>% mutate(color= if(cluster==2){color="blue"})
library(rgl)
plot3d(clust_data[,1:3], col=c("red","blue","green"))
clust_data %>% mutate(color= if(cluster==1){
color="red"
})(else if (cluster==2){color="blue"})
clust_data %>% mutate(color= if(cluster==1){
color="red"
}) %>% mutate (color=else if (cluster==2){color="blue"})
clust_data %>% mutate(color= if(cluster==1){
color="red"
}) %>% mutate (color=if (cluster==2){color="blue"})
library(rgl)
plot3d(clust_data[,1:3], col=c("red","blue","green"))
clust_data %>% mutate(color= if(cluster==1){
color="red"
})
library(rgl)
plot3d(clust_data[,1:3], col=c("red","blue","green"))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% filter(year(date)== 1978) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust1<- newdates %>% filter(year(date)== 1982) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==1982) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==1982) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
rgl.postscript("1982.png")
rgl.postscript("1982.PNG")
rgl.postscript("1982.pdf")
snapshot3d("1982")
clust1<- newdates %>% filter(year(date)== 1986) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==1986) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==1986) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% filter(year(date)== 1990) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==1990) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==1990) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% filter(year(date)== 1994) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==1994) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==1994) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% filter(year(date)== 1998) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==1998) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==1998) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% filter(year(date)== 2002) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust1<- newdates %>% filter(year(date)== 2006) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust1<- newdates %>% filter(year(date)== 2010) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust1<- newdates %>% filter(year(date)== 2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==2014) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% filter(year(date)== 1986) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==1986) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==1986) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% filter(year(date)== 2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==2014) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
rgl.snapshot(2014,fmt="png",top=True)
?rgl.snapshot
clust1<- newdates %>% filter(year(date)== 2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==2014) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
rgl.snapshot(2014,fmt="png")
clust1<- newdates %>% filter(year(date)== 2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==2014) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
rgl.snapshot(2014.png)
clust1<- newdates %>% filter(year(date)== 2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==2014) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
rgl.snapshot(2014.png)
clust1<- newdates %>% filter(year(date)== 2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==2014) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
rgl.snapshot(../Oil_Production_Analysis/2014,fmt="png")
clust1<- newdates %>% filter(year(date)== 2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==2014) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
rgl.snapshot(/Oil_Production_Analysis/2014,fmt="png")
clust1<- newdates %>% filter(year(date)== 2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==2014) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
rgl.snapshot(Oil_Production_Analysis/2014,fmt="png")
open3d()
plot3d(clust_data[,1:3], col=clust_data$cluster)
rgl.postscript("2014.pgf","pgf")
open3d()
plot3d(clust_data[,1:3], col=clust_data$cluster)
rgl.postscript("2014.pdf","pdf")
clust1<- newdates %>% filter(year(date)== 1982) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==1982) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==1982) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% filter(year(date)== 1986) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==1986) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==1986) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% filter(year(date)== 1990) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==1990) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==1990) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% filter(year(date)== 1994) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==1994) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==1994) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% filter(year(date)== 1998) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==1998) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==1998) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
newdates<-na.omit
#1978 82 86 90 94 98 02 06 10 14
years<- seq(1978,2014,4)
newdates %>% filter(year(date) %in%years)
#1978 82 86 90 94 98 02 06 10 14
years<- seq(1978,2014,4)
newdates %>% filter(year(date) %in%years)
years<- seq(1978,2014,4)
newdates %>% filter(year(date) %in%years)
#1978 82 86 90 94 98 02 06 10 14
years<- seq(1978,2014,4)
newdates %>% filter(year(date) %in%years)
library(stats4)
clust1<- newdates %>% filter(year(date)== 1994) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
library(datasets)
library(tidyverse)
library(ggplot2)
library(janitor)
library(readxl)
Production <- read_excel("Production_BCS.xlsx",
col_types = c("text", "text", "date",
"numeric", "numeric", "numeric",
"numeric")) %>% clean_names()
library(datasets)
library(tidyverse)
library(ggplot2)
library(janitor)
library(readxl)
Production <- read_excel("Production_BCS.xlsx",
col_types = c("text", "text", "date",
"numeric", "numeric", "numeric",
"numeric")) %>% clean_names()
ggplot(Production, aes(reservoir, well, color = oil_rate_bopd)) + geom_point()
head(Production)
summary(Production)
Production %>% filter(is.na(water_rate_bwpd))
library(lubridate)
Production$date<-ymd(Production$date)
newdates<-Production %>% filter(date>1973)
newdates
#1978 82 86 90 94 98 02 06 10 14
years<- seq(1978,2014,4)
newdates %>% filter(year(date) %in%years)
library(stats4)
clust1<- newdates %>% filter(year(date)== 1994) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==1994) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==1994) %>% select(well)
library(factoextra)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
clust_data %>%   ggplot(aes(x=water_rate_bwpd, y=gas_rate_mscf_d, color = factor(cluster)))+ geom_point()
clust_data %>% mutate(color= if(cluster==1){
color="red"
})
library(rgl)
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% filter(year(date)== 1982) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==1982) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==1982) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% filter(year(date)== 1986) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==1986) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==1986) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% filter(year(date)== 1990) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==1990) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==1990) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% filter(year(date)== 1994) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==1994) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==1994) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% filter(year(date)== 1998) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==1998) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==1998) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% filter(year(date)== 2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==2014) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
open3d()
plot3d(clust_data[,1:3], col=clust_data$cluster)
rgl.
#1978 82 86 90 94 98 02 06 10 14
years<- seq(1978,2014,4)
newdates %>% filter(year(date) %in%years) %>% na.omit()
clust1<- newdates %>% filter(year(date)== 1982) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==1982) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==1982) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% filter(year(date)== 1982) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==1982) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==1982) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% filter(year(date)== 2002%>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==2002%>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust1<- newdates %>% filter(year(date)==2002%>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==2002%>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust1<- newdates %>% filter(year(date)== 2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==2014) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% filter(year(date)== 2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% filter(year(date)==2014) %>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==2014) %>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% filter(year(date)== 2002)%>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
newdates %>%  filter(year(date)==2002)
newdates %>%  filter(year(date)==2002) %>%  select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
newdates %>%  filter(year(date)==2002) %>%  select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd)
newdates %>% na.omit() %>%  filter(year(date)==2002) %>%  select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale()
newdates %>% na.omit() %>%  filter(year(date)==2002) %>%  select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust1<- newdates %>% na.omit %>% filter(year(date)== 2002)%>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% na.omit %>% filter(year(date)==2002)%>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==2002)%>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% na.omit %>% filter(year(date)== 2006)%>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% na.omit %>% filter(year(date)==2006)%>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==2006)%>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% na.omit %>% filter(year(date)== 2010)%>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% na.omit %>% filter(year(date)==2010)%>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==2010)%>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
clust1<- newdates %>% na.omit %>% filter(year(date)== 2014)%>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>% scale() %>% kmeans(centers=3, nstart=10)
clust_data<- newdates %>% na.omit %>% filter(year(date)==2014)%>% select(oil_rate_bopd, gas_rate_mscf_d, water_rate_bwpd) %>%  scale()
clust_names<- newdates %>% filter(year(date)==2014)%>% select(well)
fviz_cluster(clust1, data=clust_data)
clust_data<- clust_data %>% as.tibble() %>%  mutate(cluster=clust1$cluster, well= rownames(clust_names$well))
plot3d(clust_data[,1:3], col=clust_data$cluster)
